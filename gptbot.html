<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Polymarket GPT Bot Scanner v9</title>
<style>
body {
  background:#0b0f14;
  color:#e6edf3;
  font-family:Arial, sans-serif;
}
h1 { color:#4ea1ff; }
table {
  width:100%;
  border-collapse:collapse;
}
th, td {
  padding:8px;
  border-bottom:1px solid #1f2937;
}
th { color:#9ecbff; }
a { color:#2dd4bf; text-decoration:none; }
.badge-risk { color:#ff4d4d; }
.badge-safe { color:#22c55e; }
.controls { margin:10px 0; }
.small { font-size:12px; color:#9ca3af; }
</style>
</head>

<body>

<h1>Polymarket GPT Bot Scanner v9</h1>
<div class="small">Research-first scanner. AI must justify safety.</div>

<div class="controls">
  <input id="apiKey" type="password" placeholder="Paste ChatGPT API Key" size="40">
  <button onclick="startScan()">START SCANNER</button>
</div>

<div class="controls">
  <strong>Categories:</strong>
  <label><input type="checkbox" checked> Crypto</label>
  <label><input type="checkbox" checked> Politics</label>
  <label><input type="checkbox" checked> Sports</label>
  <label><input type="checkbox" checked> Tech</label>
  <label><input type="checkbox" checked> Other</label>
</div>

<div class="controls">
  <strong>Probability Filter:</strong>
  <select id="probFilter">
    <option value="50">50%+</option>
    <option value="60">60%+</option>
    <option value="70">70%+</option>
    <option value="75">75%+</option>
    <option value="80">80%+</option>
    <option value="85">85%+</option>
    <option value="90">90–99.9%</option>
  </select>
</div>

<div id="status" class="small">Status: idle</div>

<table>
<thead>
<tr>
  <th>Select</th>
  <th>Market</th>
  <th>Side</th>
  <th>Prob</th>
  <th>Risk</th>
  <th>Status</th>
  <th>Profit (If Win)</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>

<div class="small" style="margin-top:20px;">v9</div>

<script>
const PROXY = "https://solitary-paper-639a.cryptoworldgames.workers.dev/?url=";

async function startScan() {
  document.getElementById("status").innerText = "Status: loading active markets...";
  const res = await fetch(PROXY + encodeURIComponent("https://gamma-api.polymarket.com/markets"));
  const data = await res.json();

  const now = Date.now();
  const active = data.filter(m =>
    m.active === true &&
    m.closed === false &&
    new Date(m.endDate).getTime() > now
  );

  document.getElementById("status").innerText =
    `Status: Loaded ${active.length} active markets`;

  render(active.slice(0, 50));
}

function render(markets) {
  const tbody = document.getElementById("rows");
  tbody.innerHTML = "";

  markets.forEach(m => {
    const prob = m.outcomePrices && m.outcomePrices[0]
      ? Math.round(parseFloat(m.outcomePrices[0]) * 100)
      : null;

    const risk = prob && prob >= 80 ? "SAFE" : "RISK";

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><input type="checkbox"></td>
      <td><a href="https://polymarket.com/search?_q=${encodeURIComponent(m.slug)}" target="_blank">${m.question}</a></td>
      <td>YES</td>
      <td>${prob ? prob + "%" : "—"}</td>
      <td class="${risk === "SAFE" ? "badge-safe" : "badge-risk"}">${risk}</td>
      <td>PENDING</td>
      <td>$1 → $${prob ? (100 / prob).toFixed(2) : "—"}</td>
    `;
    tbody.appendChild(tr);
  });
}
</script>

</body>
</html>
